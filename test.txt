These changes are from master
